# Noah

Noah is a Darwin subsystem for Linux, or "Bash on Ubuntu on Mac OS X". Noah is implemented as a hypervisor that traps linux system calls and translates them into Darwin's system calls. Noah also has an interpreter of ELF files so that binary executables of Linux run directly and flawlessly without any modifications.

## Quick Start

Noah is installed via homebrew. We strongly recommend additionally installing noahstrap! With noahstrap, you get a comprehensive linux environment via a few lines of commands:

    $ brew tap linux-noah/noah
    $ brew install noah noahstrap
    $ mkdir test-chroot
    $ sudo noahstrap archlinux ./test-chroot
    $ noah -m ./test-chroot /bin/bash -i

## (Advanced Topic) How to set up an environment with Vagrant on macOS

1. Install [Vagrant](https://www.vagrantup.com/) and [VirtualBox](https://www.virtualbox.org/).
1. Run `$ vagrant init hashicorp/precise64` to generate `Vagrantfile`.
1. Add the following settings to `Vagrantfile`.

   ```
   config.vm.network :forwarded_port, guest:22, host:2222, id:"ssh"
   config.vm.network "private_network", ip: "192.168.33.10"
   ```

1. Change the following lines in `Makefile`.

   ```
   #LINUX_BUILD_SERV := idylls.jp
   LINUX_BUILD_SERV := 192.168.33.10
   ```

1. Add the following host to `~/.ssh/config` (generated by `$ vagrant ssh-config`)

   ```
   Host 192.168.33.10
	    HostName 127.0.0.1
	    User vagrant
	    Port 2222
	    UserKnownHostsFile /dev/null
	    StrictHostKeyChecking no
	    PasswordAuthentication no
	    IdentityFile /Users/yasulab/noah/.vagrant/machines/default/virtualbox/private_key
	    IdentitiesOnly yes
	    LogLevel FATAL
   ```
1. Run `$ vagrant up` to get a linux machine to execute `noah`.
1. Run `$ make run` to check if your macOS can run `noah`.
1. If you successfully configure above, you should get the following result.

   ```
   ./build/noah test/test_stdout/build/hello
   hello, world!
   ```
